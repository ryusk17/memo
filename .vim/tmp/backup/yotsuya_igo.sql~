USE `yotsuyaotsuka_igo`;

SET SESSION FOREIGN_KEY_CHECKS=0;

/* Drop Indexes */

DROP INDEX deleted ON event_list;
DROP INDEX deleted ON event_number_people;



/* Drop Tables */

DROP TABLE IF EXISTS event_number_people;
DROP TABLE IF EXISTS event_list;




/* Create Tables */

-- イベントリスト
CREATE TABLE event_list
(
	id int(11) NOT NULL AUTO_INCREMENT COMMENT 'イベントID',
	kousha varchar(100) NOT NULL COMMENT '校舎名',
	date varchar(100) NOT NULL COMMENT '日程',
	time varchar(100) NOT NULL COMMENT '時間',
	-- 1:表示, 0:非表示
	visible_flag tinyint(1) DEFAULT 0 NOT NULL COMMENT '表示フラグ : 1:表示, 0:非表示',
	max_people int(11) DEFAULT 0 NOT NULL COMMENT '最大人数',
	grade varchar(100) NOT NULL COMMENT '学年',
	created datetime NOT NULL COMMENT '作成日時',
	modified datetime NOT NULL COMMENT '更新日時',
	deleted datetime COMMENT '削除日時',
	PRIMARY KEY (id)
) ENGINE = InnoDB COMMENT = 'イベントリスト' DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;


-- イベント応募人数
CREATE TABLE event_number_people
(
	id int(11) NOT NULL AUTO_INCREMENT COMMENT 'id',
	event_id int(11) NOT NULL COMMENT 'イベントID',
	count_people int(11) NOT NULL COMMENT '応募人数',
	created datetime NOT NULL COMMENT '作成日時',
	modified datetime NOT NULL COMMENT '更新日時',
	deleted datetime COMMENT '削除日時',
	PRIMARY KEY (id),
	UNIQUE (event_id)
) ENGINE = InnoDB COMMENT = 'イベント応募人数' DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;



/* Create Foreign Keys */

ALTER TABLE event_number_people
	ADD FOREIGN KEY (event_id)
	REFERENCES event_list (id)
	ON UPDATE RESTRICT
	ON DELETE RESTRICT
;



/* Create Indexes */

CREATE INDEX deleted ON event_list (deleted ASC);
CREATE INDEX deleted ON event_number_people (deleted ASC);



